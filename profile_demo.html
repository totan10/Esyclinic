<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload Prescription</title>
</head>

<body>
    <input type="file" id="prescriptionFile">
    <button onclick="uploadPrescription()">Upload Prescription</button>

    <script>
        // Function to create sample FormData and send it to the server
        async function uploadPrescription() {
            // Create a new FormData object
            let formData = new FormData();

            // Append data to the FormData object
            formData.append('ADVICE_DR', 'Dr. Smith');
            formData.append('PATIENT_ID', '123456');
            formData.append('MOBILE', '9876543210');
            formData.append('PHARMA_ID', '654321');
            formData.append('MESSAGE', 'Take medication twice a day');
            const data = [
                {
                    "PHARMA_ID": 8,
                    "BOOK_DATE": "20240528",
                    "BOOK_TIME": "13:13:16",
                    "BOOK_BY_ID": "8170087168",
                    "BOOK_BY_NAME": "SURAKSHA CLINIC",
                    "PATIENT_ID": "7001930641",
                    "PATIENT_NAME": "Totan Debnath",
                    "ADVICED_BY": "",
                    "PRESCRIPTION_URL": "file:///storage/emulated/0/Android/data/com.easyhealthb2b/files/Pictures/e22a4fd3-6688-4255-ac48-239f424a1b21.jpg",
                    "MESSAGE": "this is tinku",
                    "MOBILE_NO": 7001930641,
                    "DETAILS": [
                        {
                            "TEST_ID": 1020,
                            "TEST_NAME": "Hb%",
                            "CATEGORY": "",
                            "SLOT_DATE": "20240528",
                            "FROM": "6AM",
                            "TO": "7AM",
                            "HOME_COLLECT": "TRUE",
                            "COST": 100
                        },
                        {
                            "TEST_ID": 100,
                            "TEST_NAME": "MP (THICK & THIN)",
                            "CATEGORY": "",
                            "SLOT_DATE": "20240528",
                            "FROM": "6AM",
                            "TO": "7AM",
                            "HOME_COLLECT": "TRUE",
                            "COST": 100
                        },
                        {
                            "TEST_ID": 10,
                            "TEST_NAME": "BICARBONATE (HCO3-)",
                            "CATEGORY": "",
                            "SLOT_DATE": "20240528",
                            "FROM": "6AM",
                            "TO": "7AM",
                            "HOME_COLLECT": "TRUE",
                            "COST": 500
                        }
                    ]
                }
            ]

            formData.append('BOOK_TEST', data);
            // Get the file input element
            let fileInput = document.getElementById('prescriptionFile');
            if (fileInput.files.length > 0) {
                formData.append('file', fileInput.files[0]);
            } else {
                console.error('No file selected!');
                return;
            }
            console.log(formData);
            for (const [key, value] of formData) {
                console.log(`${key}: ${value}`)
            }
            // Send the FormData using fetch
            try {
                let response = await fetch('http://yourapiurl/upprescription', {
                    method: 'POST',
                    body: formData,
                });

                let result = await response.json();
                console.log(result);
            } catch (error) {
                console.error('Error:', error);
            }
        }

        // Event listener for button click (optional, can be used instead of inline onclick)
        // document.getElementById('uploadButton').addEventListener('click', uploadPrescription);

    </script>
</body>

</html>