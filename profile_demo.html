<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scroll Animation with Advanced Techniques</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            height: 2000px; /* Set height to allow scrolling */
        }

        #animation-section {
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #f0f0f0;
            position: relative;
            overflow: hidden;
        }

        #animated-image {
            position: absolute;
            left: 0;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.4.0/animate.min.css"> 
</head>
<body>
    <div id="animation-section">
        <img id="animated-image" src="/afternoon_icon.jpeg" alt="Animated Image">
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const section = document.getElementById('animation-section');
            const animatedImage = document.getElementById('animated-image');
            let lastScrollPosition = 0;
            let isScrolling = false;
            let resizeTimeout;

            function isInViewport(element) {
                const rect = element.getBoundingClientRect();
                return (
                    rect.top >= 0 &&
                    rect.left >= 0 &&
                    rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
                    rect.right <= (window.innerWidth || document.documentElement.clientWidth)
                );
            }

            function handleScroll() {
                const currentScrollPosition = window.scrollY;

                if (!isScrolling) {
                    if (currentScrollPosition > lastScrollPosition) {
                        // Scrolling down
                        animatedImage.style.opacity = 1; // Fade in
                    } else {
                        // Scrolling up
                        animatedImage.style.opacity = 0; // Fade out
                    }

                    const sectionTop = section.offsetTop;
                    const distance = currentScrollPosition - sectionTop;
                    const parallaxFactor = 0.5; // Adjust this value for desired parallax effect
                    animatedImage.style.transform = `translateX(${distance * parallaxFactor}px)`;

                    lastScrollPosition = currentScrollPosition;
                    isScrolling = true;
                    setTimeout(() => {
                        isScrolling = false;
                    }, 100); // Adjust throttle delay (in milliseconds) as needed
                }
            }

            function handleResize() {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => {
                    handleScroll(); // Re-calculate positions on resize
                }, 200); // Adjust delay (in milliseconds) as needed
            }

            function initAnimation() {
                window.addEventListener('scroll', handleScroll);
                window.addEventListener('resize', handleResize);
                handleScroll(); // Initial check on page load
            }

            initAnimation();
        });
    </script>
</body>
</html>
